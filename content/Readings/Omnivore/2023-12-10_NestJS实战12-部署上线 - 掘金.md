---
id: bf1eeefa-97ec-11ee-810f-8beba21991f9
title: |
  NestJSå®æˆ˜12-éƒ¨ç½²ä¸Šçº¿ - æ˜é‡‘
author: |
  é›ªéš_ä¸Šç­äº†
date_saved: 2023-12-10 21:19:51
date_published: 2023-12-10 21:19:51
draft: true
---

# NestJSå®æˆ˜12-éƒ¨ç½²ä¸Šçº¿ - æ˜é‡‘
#Omnivore

[Read on Omnivore](https://omnivore.app/me/nest-js-12-18c578498d8)

[Read Original](https://juejin.cn/post/7310569308916400140)

date_saved: 2023-12-10 21:19:51

date_published: 2023-12-10 21:19:51

--- 

# Full Content: 

> by é›ªéš from [juejin.cn/user/143341â€¦](https://juejin.cn/user/1433418895994094 "https://juejin.cn/user/1433418895994094")
> 
> æœ¬æ–‡æ¬¢è¿åˆ†äº«ä¸èšåˆï¼Œå…¨æ–‡è½¬è½½å°±ä¸å¿…äº†ï¼Œå°Šé‡ç‰ˆæƒï¼Œåœˆå­å°±è¿™ä¹ˆå¤§ï¼Œè‹¥æ€¥ç”¨å¯è”ç³»æˆæƒ

## æ¦‚è¿°

åŸºæœ¬ä¸Šå¼€å‘çš„å†…å®¹å·®ä¸å¤šäº†ï¼Œç°åœ¨å°±å¯ä»¥éƒ¨ç½²ä¸Šçº¿è¯•ä¸€è¯•äº†ã€‚

## æœåŠ¡å™¨å’ŒåŸŸå

è¿™ä¸ªç½‘ä¸Šæœ‰å¾ˆå¤šå‚è€ƒï¼š[ã€å»ºç«™ã€‘ å»ºç«™ç¬¬ä¸€å¤© â€”â€” åŸŸåã€äº‘æœåŠ¡å™¨ã€åŸŸåè§£æ](https://link.juejin.cn/?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F614793871 "https://zhuanlan.zhihu.com/p/614793871")ï¼Œå¤§å®¶æ ¹æ®è‡ªå·±çš„æƒ…å†µè´­ä¹°ä¸€ä¸ªæœ‰å…¬ç½‘Ipçš„Linuxç³»ç»Ÿçš„äº‘æœåŠ¡å³å¯ï¼Œè¿˜æœ‰ä¹°ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„åŸŸåã€‚

## Dockerç¯å¢ƒé…ç½®

æˆ‘ä¹‹å‰å†™è¿‡ï¼Œä¸»è¦å°±æ˜¯æ ¹æ®å®˜ç½‘é…ç½®å³å¯[dockerç¯å¢ƒ](https://juejin.cn/post/7197442576906715194 "https://juejin.cn/post/7197442576906715194")ã€‚

## dockerå†…å®¹åšæˆä»¥åŠéƒ¨ç½²

æœ€åæŠŠæˆ‘çš„ä¸‹é¢çš„å†…å®¹åšæˆyamlæ–‡ä»¶(docker-compose.yml)ï¼š

```jboss-cli
version: "3"
services:
  webserver:
    image: nginx
    volumes:
      - ./default.conf:/etc/nginx/conf.d/default.conf
      - "./website:/var/www/html/website"
      - ./nginx_logs:/var/log/nginx
    depends_on:
      - backend
    ports:
      - "80:80"

  backend:
    image: "node:20-bullseye-slim"
    user: "root"
    working_dir: /home/app
    container_name: gateway-service-dev
    ports:
      - "8000:8000"
    volumes:
      # åˆ›å»º/uploadsç›®å½•å¹¶æŒ‚è½½
      - ./uploads:/home/app/uploads
      # åˆ›å»º/downloadsç›®å½•å¹¶æŒ‚è½½
      - ./website/downloads:/home/app/public/downloads
      # æŒ‚è½½æ—¥å¿—
      - ./logs:/home/app/logs
      # æŒ‚è½½é…ç½®æ–‡ä»¶
      - ./config:/home/app/config
      # æŒ‚è½½å„ç§ç¬¬ä¸‰æ–¹æ’ä»¶
      - ./node_modules:/home/app/node_modules
      # æŒ‚è½½ä¸»è¦ç¨‹åº
      - ./dist:/home/app/dist
    # æ›´æ”¹ç”¨æˆ·ç»„å’Œç›®å½•æƒé™
    command: sh -c "chown -R 777 /home/app/uploads && node /home/app/dist/main.js"
    environment:
      RUNNING_ENV: 'prod'

```

æŠŠå‰åç«¯çš„é¡¹ç›®å¤åˆ¶åˆ°æœåŠ¡å™¨ä¸Š![image.png](https://proxy-prod.omnivore-image-cache.app/0x0,sor4C2JTIm1atBKwtT_iXYMAL87d0tKTbS5fkbj5IFzE/https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f45c5596b67140009d5525c696c67e07~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1358&h=494&s=204560&e=jpg&b=fbfafa)

ç¼–å†™nginxçš„configæ–‡ä»¶

```nginx
upstream backend {
    server backend:8000;
}

server {
    listen 80 default_server;
    server_name _;

    location /api/ {
        proxy_pass http://backend;
    }

    # é…ç½®è®¿é—®åç«¯çš„publicç›®å½•
    location /backend/public/ {
        alias /var/www/backend/public/;
    }

    location / {
        root /var/www/html/website;
        index index.html index.htm;
        try_files $uri $uri/ /index.html;
    }
}

```

ç„¶åè¿è¡Œdocke-compose

```ada
docker-compose up -d --build

```

## æ€»ç»“

å®Œç»“æ’’èŠ±ï¼ŒåŸºæœ¬ä¸Šæˆ‘çš„ä¸ªäººç®¡ç†ç³»ç»Ÿå’Œæ ¸å¿ƒçš„çŸ¥è¯†ç‚¹éƒ½å’Œå¤§å®¶ä»‹ç»å®Œæ¯•äº†ã€‚å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ ä»¬æœ‰å¸®åŠ©ï¼Œè¯·è®°å¾—ç‚¹èµè¯„è®ºğŸ™ï¼

## dockerä»£ç 

[ä»£ç ](https://link.juejin.cn/?target=https%3A%2F%2Fgitee.com%2Fshenxf1986%2Fjuejin-personManager%2Ftree%2Fmaster%2Flesson12 "https://gitee.com/shenxf1986/juejin-personManager/tree/master/lesson12")

---

